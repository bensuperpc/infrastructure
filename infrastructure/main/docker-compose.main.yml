services:
  main_infrastructure:
    container_name: main_infrastructure
    image: debian:latest
    profiles:
      - main_infrastructure
    user: "root"
    group_add:
      - '${PUID:-1000}'
    volumes:
      - public_data:/public
      - private_data:/private
    networks:
      - infra-network
    # Fix root permissions on mounted volumes
    command: chown -R ${PUID:-1000}:${PGID:-1000} /public /private

volumes:
  public_data:
    name: public_data
  private_data:
    name: private_data

networks:
  infra-network:
    driver: bridge
    name: infra-network